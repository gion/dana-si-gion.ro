"use strict";!function(a,b,c,d,e,f,g,h,i,j){c(document).ready(function(c){function k(){var d=c(a),e=1100,f=d.height(),g=c(".scrollContent").outerHeight();b.backgroundScene.duration(g-f/2),b.bikeScene.duration(g-f/2),c.each(l,function(a,b){c(b.triggerElement())}),c(".scene-element-wrapper").width(e),c(".scene-element").css("transformOrigin",e/2+100+"px "+(f/2+100)+"px"),c("#origin-helper").css({top:f/2+(c(".scene.active .scene-element-wrapper").length?c(".scene.active .scene-element-wrapper").offset().top:0),left:e/2})}c("#bullets").on("click",".bullet",function(a){var d=c(a.target).index();console.log(d,a.target),b.goToScene(d)}),b.animateScroll=function(a,d){b.animateScroll.tween&&b.animateScroll.tween.kill(),console.log("animate scroll",a);var f=c(".scrollContainer").get(0),g={y:f.scrollTop};b.animateScroll.tween=e.to(g,d||1,{y:a,onUpdate:function(){f.scrollTop=g.y}})},b.goToScene=function(d){{var e;c(".scene:not(.fixed)").eq(d)}return b.scenes[d]?(e=b.scenes[d].startPosition()-c(a).height()/2+10,void b.animateScroll(e)):(console.error("not a valid index scene",d),!1)},b.getBubbles=function(){return b.getBubbles.promise||(b.getBubbles.promise=c.ajax({url:"data/bubbles.json",method:"get",dataType:"json"})),b.getBubbles.promise},b.renderBubbles=function(a){var b=d.template('<a class="<%=scene%>" target="blank" title="<%=title%>" href="<%=link%>" style="background-image: url(<%=image%>)"></a>'),e=c(".bubble-3").empty();c.each(a,function(a,c){e.append(b(c))})},b.initBubbles=function(){b.getBubbles().success(b.renderBubbles)},b.activateBubble=function(a){c(".bubble-wrapper, .bubble-wrapper .bubble-3 a."+a).addClass("active")},b.deactivateBubble=function(a){c(".bubble-wrapper, .bubble-wrapper .bubble-3 a."+a).removeClass("active")},b.onTimelineUpdate=function(){var a=this.progress(),c=.4;a>c&&1-c>a&&!this.bubbleActivated?(this.bubbleActivated=!0,b.activateBubble(this.sceneName)):(c>a||a>1-c)&&this.bubbleActivated&&(this.bubbleActivated=!1,b.deactivateBubble(this.sceneName)),console.log(a,this.bubbleActivated)};var l=b.scenes=[],m=b.controller=new g({container:"#example-wrapper"}),n=c(".clouds"),o=e.to("#mobileadvanced #hill",1,{rotation:"-720deg",onUpdate:function(){var a=-(100*this.progress())+"% 0";n.css("background-position",a)}}),p=b.backgroundScene=new h({triggerElement:c("#background").get(0),duration:c(".scrollContent").height()}).setTween(o).setPin("#mobileadvanced",{pushFollowers:!1}).addTo(m);if(p.on("enter",function(){c("body").removeClass("finished"),c("body").addClass("scene-background"),c(p.triggerElement()).addClass("active")}),p.on("leave",function(){c(p.triggerElement()).removeClass("active"),c("body").addClass("finished"),c("body").removeClass("scene-background")}),c(".scene.fixed:last").each(function(a,d){var f=new h({triggerElement:d,duration:c(".scrollContent").height(),offset:-200});c(".scene-element-wrapper",d).each(function(a,b){var d=c(".scene-element",b).get(0);f.setPin(b,{pushFollowers:!1}).setTween(e.fromTo(d,1,{rotation:"-125deg"},{rotation:"125deg"}))}),f.on("enter",function(){c(f.triggerElement()).addClass("active")}),f.on("leave",function(){c(f.triggerElement()).removeClass("active")}),b.bikeScene=f,f.addTo(m),f.addIndicators()}),c(".scene:not(.fixed)").each(function(a,d){var g=new h({triggerElement:d,offset:-200,duration:c(d).data("duration")||c(d).height()}),i=c(d).attr("id"),j=new f({onUpdate:b.onTimelineUpdate});j.sceneName=i,c(".scene-element-wrapper",d).each(function(a,b){var d=c(".scene-element",b).get(0),f=(c(".scene-description",b),e.fromTo(d,1,{rotation:"135deg"},{rotation:"-135deg"}));j.add(f)}),g.on("enter",function(){c(g.triggerElement()).addClass("active");var a=l.indexOf(g);c("#bullets .bullet").removeClass("active").eq(a).addClass("active"),c("body").addClass("scene-"+i)}),g.on("leave",function(){c(g.triggerElement()).removeClass("active"),c("body").removeClass("scene-"+i)}),g.setTween(j),g.addTo(m),g.addIndicators(),l.push(g)}),i.touch){var q=new j("#example-wrapper",{scrollX:!1,scrollY:!0,scrollbars:!0,useTransform:!1,useTransition:!1,probeType:3});m.scrollPos(function(){return-q.y}),q.on("scroll",function(){m.update()}),p.addIndicators({parent:".scrollContent"})}else p.addIndicators();c.each(b.scenes,function(){c('<li class="bullet heart cursor-pointer"></li>').appendTo("#bullets")}),c(a).on("resize",k),k(),b.initBubbles()})}(this,this.api=this.api||{},this.jQuery,this._,this.TweenMax,this.TimelineMax,this.ScrollMagic,this.ScrollScene,this.Modernizr,this.IScroll);